!function(e){"use strict";var t=Backbone.View.extend({el:"body",events:_.extend({},Backbone.Events),collections:{},model:null,Views:{},views:{},viewsToLoad:{},registrationSteps:["Step 1: Email Address","Step 2: Your Information","Step 3: Donation","Step 4: Thank You"],initialize:function(){e(function(){app.views.affiliateDropDown=new app.Views.AffiliateDropDown,app.views.header=new app.Views.Header,app.views.footer=new app.Views.Footer;for(var e=0;e<window.modulesToInit.length;e++){var t=modulesToInit[e],i="",n={};"string"==typeof t?i=t:(i=t.view,n=t.options);for(var a=1,o=i;"undefined"!=typeof app.views[o];)o=i+"_"+a,a++;app.views[o]=new app.Views[i](n)}})}});window.app=new t}(jQuery),function(e){"use strict";window.SmoothValidator=function(t){var i=null,n=null,a=[],o="";o+='<div class="form-validation-wrapper">',o+='    <div class="form-validation">',o+="        Please clarify the following:",o+='        <ul class="validation-list"></ul>',o+="    </div>",o+="</div>",this.$validationSummary=e(o),t.prepend(this.$validationSummary),this.validateAndBuildData=function(){i=t.find("input:not(:radio):not(:checkbox),select,textarea"),n=t.find(".form-radio-buttons, .form-checkbox-group"),i.removeClass("cleared validation-error"),n.removeClass("cleared validation-error"),"undefined"==typeof t.attr("data-bound-revalidation")&&(i.on("input change",_.bind(function(t){this.revalidateField(e(t.currentTarget))},this)),n.on("input change",_.bind(function(t){this.revalidateField(e(t.currentTarget))},this)),t.attr("data-bound-revalidation","bound"));var a={},o={},s=0;for(s=0;s<i.length;s++){var l=i.eq(s),r=l.prop("id"),d=this.validateField(l);d!==!0&&(o[r]=d),a[r]=l.val()}for(s=0;s<n.length;s++){for(var c=n.eq(s),h=c.find("input:checked"),p=h.eq(0).val(),f=1;f<h.length;f++)console.log(h),p+=","+h.eq(f).val();var u=c.prop("id"),v=c.attr("data-friendly-name"),g={friendlyName:v,inputId:u,inputVal:p},m=this.validateField(c,g);m!==!0&&(o[u]=m),a[u]=p}return 0===_.size(o)?a:(this.renderValidationErrors(o),null)},this.renderValidationErrors=function(t){this.clearValidation(),e.each(t,_.bind(function(e,t){var a=i.filter("#"+e);0===a.length&&(a=n.filter("#"+e)),a.addClass("validation-error"),this.$validationSummary.find(".validation-list").append('<li class="error-'+e+'">'+t+"</li>")},this));var a=this.$validationSummary.find(".form-validation").outerHeight()+20;tween.to(this.$validationSummary,.6,{css:{autoAlpha:1,height:a}}),tween.to(e("html, body"),.6,{scrollTop:this.$validationSummary.offset().top-20})},this.clearValidation=function(){this.$validationSummary.find(".validation-list").empty(),this.$validationSummary.css({visibility:"hidden",height:0}),i.removeClass("validation-error")},this.revalidateField=function(t){t.hasClass("validation-error")&&(t.hasClass("form-radio-buttons")||t.hasClass("form-checkbox-group")?this.revalidateGroup(t):this.revalidateInput(t));var i=t[0].getAttribute("data-v-revalidate");if(null!==i){var n=e(i);a.push(t.prop("id"));for(var o=!1,s=0;s<a.length;s++)if(n.prop("id")===a[s]){o=!0;break}o===!1?this.revalidateField(n):this.endRevalidation()}else this.endRevalidation()},this.endRevalidation=function(){a=[]},this.revalidateInput=function(e){if(e.hasClass("validation-error")){var t=this.validateField(e),i=e.prop("id"),n=this.$validationSummary.find(".error-"+i);t===!0?(n.addClass("cleared"),e.addClass("cleared")):(n.text(t),n.removeClass("cleared"),e.removeClass("cleared"))}},this.revalidateGroup=function(e){if(e.hasClass("validation-error")){var t=e.find("input:checked"),i=e.prop("id"),n=t.val(),a=e.attr("data-friendly-name"),o=this.$validationSummary.find(".error-"+i),s={friendlyName:a,inputId:i,inputVal:n},l=this.validateField(e,s);l===!0?(o.addClass("cleared"),e.addClass("cleared")):(o.text(l),o.removeClass("cleared"),e.removeClass("cleared"))}},this.validateField=function(t,i){var n,a,o;"undefined"!=typeof i&&(n=i.inputVal,a=i.inputId,o=i.friendlyName),"undefined"==typeof n&&(n=t.val()),"undefined"==typeof a&&(a=t.prop("id")),"undefined"==typeof o&&(o=t.prev("label").text());var s=t[0].getAttribute("data-v-required"),l=t[0].getAttribute("data-v-min-width"),r=t[0].getAttribute("data-v-must-equal"),d=t[0].getAttribute("data-v-required-with"),c=t[0].getAttribute("data-v-numeric-floor"),h=t[0].getAttribute("data-v-format-email"),p=t[0].getAttribute("data-v-format-currency"),f=t[0].getAttribute("data-v-format-numeric"),u=t[0].getAttribute("data-v-format-credit-card");if(null!==s&&(0===n.length||"undefined"==typeof n))return o+" is required.";if(null!==l){var v=parseInt(l);if(!isNaN(v)&&n.length<v)return o+" must be at least "+l+" characters"}if(null!==r){var g=e(r),m=g.val();if(g.attr("data-v-revalidate","#"+a),void 0!==typeof m&&m!==n){var w=g.prev("label").text();return o+" must match "+w}}if(null!==d){console.log("required-with");var $=e(d),b=$.val();if($.attr("data-v-revalidate","#"+a),console.log($),void 0!==typeof b&&b.length>0&&(0===n.length||"undefined"==typeof n)){console.log("fail");var y=$.prev("label").text();return o+" is required when "+y+" has a value."}}if(null!=c&&parseInt(n)<parseInt(c))return o+" has a minimum value of "+c;if(null!==f&&n.length>0&&isNaN(n)===!0)return o+" must be numeric.";if(null!==h&&n.length>0&&null===n.match(/.+@.+\..+/i))return o+" is not a valid email address";if(null!==u&&n.length>0){for(var C=n.length,k=0,x=[[0,1,2,3,4,5,6,7,8,9],[0,2,4,6,8,1,3,5,7,9]],A=0;C--;)A+=x[k][parseInt(n.charAt(C),10)],k^=1;if(A%10!==0||A<=0||n.length<15)return o+" is not a valid credit card number"}return!(null!==p&&n.length>0&&null===n.match(/^[+-]?[0-9]{1,3}(?:,?[0-9]{3})*(?:\.[0-9]{2})?$/))||o+" must be a valid US currency amount"}}}(jQuery),function(e){"use strict"}(jQuery),function(e){"use strict"}(jQuery),function(e){"use strict";app.Views.GlobalHomePage=Backbone.View.extend({el:"#content",events:{"click #home-header-controls > li":"slideControlsClick","mouseenter .home-header-slide-wrapper":"clearSlideTimer","mouseleave .home-header-slide-wrapper":"queueSlideTimer"},$slides:null,$slideControls:null,slideTimer:null,currentSlideIndex:0,slideTimerLength:6e3,initialize:function(){this.$slides=this.$el.find(".home-header-slide"),this.$slideControls=this.$el.find("#home-header-controls > li"),tween.set(this.$slides.filter(".active"),{autoAlpha:1}),this.queueSlideTimer();var e=this.$el.find(".home-header-slide-wrapper");e.on("swipeleft",_.bind(this.nextPage,this)),e.on("swiperight",_.bind(this.prevPage,this))},queueSlideTimer:function(){null===this.slideTimer&&(this.slideTimer=setTimeout(_.bind(function(){var e=this.currentSlideIndex+1;e>=this.$slideControls.length&&(e=0),this.changeSlide(e)},this),this.slideTimerLength))},clearSlideTimer:function(){clearTimeout(this.slideTimer),this.slideTimer=null},nextPage:function(){var e=this.currentSlideIndex+1;this.changeSlide(e),this.clearSlideTimer()},prevPage:function(){var e=this.currentSlideIndex-1;this.changeSlide(e),this.clearSlideTimer()},changeSlide:function(e){if(e>=0&&e<this.$slides.length){var t=this.$slides.eq(e),i=this.$slides.filter(".active"),n=this.$slideControls.eq(e);tween.to(i,.4,{autoAlpha:0,onComplete:_.bind(function(){i.removeClass("active"),t.addClass("active"),tween.to(t,.4,{autoAlpha:1}),this.queueSlideTimer()},this)}),n.addClass("active").siblings().removeClass("active"),this.currentSlideIndex=e}},slideControlsClick:function(t){var i=e(t.currentTarget),n=i.index();this.changeSlide(n),this.clearSlideTimer()}}),app.Views.SingleEventPage=Backbone.View.extend({el:"#main",events:{"click .event-full-tickets-btn":"showBooking"},initialize:function(){this.createMap();var e=this.$el.find(".em-booking-form");e.next("br").remove();var t=this.$el.find(".em-tickets");0===t.length&&e.find(".em-booking-form-details").addClass("solo");var i=this.$el.find(".em-booking").find("a[href*=my-bookings]");i.remove()},showBooking:function(){var t=this.$el.find(".single-event-tickets-wrapper");tween.to(e("html, body"),2,{scrollTop:t.offset().top-20})},createMap:function(){var e=this.$el.find(".event-full-location-map");if(0!==e.length){var t=e[0],i=new google.maps.LatLng(e.attr("data-lat"),e.attr("data-lng")),n=e.attr("data-name"),a={center:i,mapTypeId:google.maps.MapTypeId.ROADMAP,zoom:15};this.map=new google.maps.Map(t,a);var o=new google.maps.Marker({position:i,map:this.map});o.infoWindow=new google.maps.InfoWindow({content:n,closeBoxUrl:""}),o.infoWindow.open(this.map,o);var s=[{stylers:[{hue:"#f1e9db"},{lightness:42}]},{featureType:"water",elementType:"all",stylers:[{color:"#d7c7a6"}]}];this.map.setOptions({styles:s})}}}),app.Views.NearEventsList=Backbone.View.extend({el:".near-events-wrapper",events:{"click button":"tabsClicked","click .near-events-controls-wrapper > ul > li":"pageControlsClick"},$contentWrapper:null,contentWrapperPadding:0,$upcomingWrapper:null,$pastWrapper:null,$pageControls:null,$controlsHeight:0,initialize:function(){this.$contentWrapper=this.$el.find(".near-events-content-wrapper"),this.contentWrapperPadding=parseInt(this.$contentWrapper.css("padding-top"))+parseInt(this.$contentWrapper.css("padding-bottom")),this.$upcomingWrapper=this.$el.find(".near-events-upcoming-wrapper"),this.$pastWrapper=this.$el.find(".near-events-past-wrapper"),this.$pageControls=this.$el.find(".near-events-controls-wrapper > ul"),window.onload=_.bind(function(){this.initializeTabs(),e(window).resize(_.bind(this.resizeWrapper,this))},this)},initializeTabs:function(){var e=this.$el.find(".near-events-upcoming-wrapper"),t=e.find(".near-events-page").length;if(t>0)this.showNewContent(0);else{this.showNewContent(1);var i=this.$el.find(".near-events-nav-upcoming"),n=this.$el.find(".near-events-nav-past");n.addClass("solo"),i.hide()}},resizeWrapper:function(e){var t=this.$contentWrapper.find(".active").find(".near-events-page.open");if(t.length>0){var i=t.outerHeight(),n=this.$pageControls.outerHeight(),a=i+this.contentWrapperPadding+n;this.$contentWrapper.find(".near-events-content");tween.to(this.$contentWrapper,.3,{height:a,onComplete:function(){"undefined"!=typeof e&&"function"==typeof e&&e()}})}},buildPageNavHtml:function(e){for(var t="",i=0;i<e;i++)t+=0===i?'<li class="active"></li>':"<li></li>";return t},pageControlsClick:function(t){var i=e(t.currentTarget),n=i.index();this.showPage(n,.45)},showPage:function(e,t,i){"undefined"==typeof t&&(t=0),this.$pageControls.children().eq(e).addClass("active").siblings(".active").removeClass("active");var n=this.$el.find(".near-events-content.active"),a=n.find(".near-events-page"),o=a.filter(".open").removeClass("open"),s=a.eq(e).addClass("open");tween.to(o,t,{autoAlpha:0}),tween.to(s,t,{autoAlpha:1}),this.resizeWrapper(i)},tabsClicked:function(t){var i=e(t.currentTarget),n=i.index();this.showNewContent(n)},showNewContent:function(e){var t=this.$el.find(".near-events-content").eq(e),i=this.$el.find(".near-events-content.active"),n=this.$el.find(".near-events-nav");n.eq(e).addClass("active").siblings().removeClass("active"),tween.to(i,.45,{autoAlpha:0}),tween.to(this.$pageControls,.45,{autoAlpha:0,onComplete:_.bind(function(){var e=t.find(".near-events-page").length;if(e>1){var n=this.buildPageNavHtml(e);this.$pageControls.html(n)}tween.set(t,{autoAlpha:0}),i.removeClass("active"),t.addClass("active"),this.showPage(0,0,_.bind(function(){tween.to(t,.45,{autoAlpha:1}),e>1&&tween.to(this.$pageControls,.45,{autoAlpha:1})},this))},this)})}}),app.Views.AffiliateListPage=Backbone.View.extend({el:"#affiliate-list-wrapper",events:{"click .affiliate-list-nav":"navClick"},numberOfColumns:3,$contentWrapper:null,$contentItems:null,$navItems:null,activeIndex:null,initialize:function(){this.$contentWrapper=this.$el.find(".affiliate-list-content-wrapper"),this.$contentItems=this.$contentWrapper.find(".affiliate-list-content"),this.$navItems=this.$el.find(".affiliate-list-nav"),this.showContent(0,0);var t=_.debounce(this.resizeContent,250);e(window).on("resize",_.bind(t,this))},navClick:function(t){var i=e(t.currentTarget),n=i.index();this.showContent(n)},resizeContent:function(){var e=this.$contentItems.eq(this.activeIndex),t=e.outerHeight();tween.to(this.$contentWrapper,.6,{height:t})},showContent:function(e,t){if(void 0===t&&(t=.6),null!==this.activeIndex&&this.activeIndex!==e){this.$navItems.eq(this.activeIndex).removeClass("active");var i=this.$contentItems.eq(this.activeIndex);tween.to(i,.6,{autoAlpha:0})}this.$navItems.eq(e).addClass("active");var n=this.$contentItems.eq(e);tween.to(n,t,{autoAlpha:1});var a=n.outerHeight();tween.to(this.$contentWrapper,t,{height:a}),this.activeIndex=e},sizeWrapper:function(){}}),app.Views.FeaturedPagedList=Backbone.View.extend({el:".featured-paged-wrapper",events:{"click .featured-paged-nav li":"navClick"},$nav:null,$slides:null,activeSlideIndex:null,initialize:function(){this.$nav=this.$el.find(".featured-paged-nav"),this.$slides=this.$el.find(".featured-paged-list > li");var e=this.$slides.filter(".active");this.activeSlideIndex=e.index(),this.$el.on("swipeleft",_.bind(this.nextPage,this)),this.$el.on("swiperight",_.bind(this.prevPage,this))},nextPage:function(){this.showPage(this.activeSlideIndex+1)},prevPage:function(){this.showPage(this.activeSlideIndex-1)},navClick:function(t){var i=e(t.currentTarget),n=i.index();this.showPage(n)},showPage:function(e){if(e>=0&&e<this.$slides.length){var t=this,i=this.$slides.eq(e),n=this.$slides.eq(this.activeSlideIndex);tween.to(n,.5,{css:{autoAlpha:0},onComplete:function(){n.hide(),i.show(),tween.to(i,.5,{css:{autoAlpha:1}}),t.activeSlideIndex=e}}),this.$nav.children().removeClass("active").eq(e).addClass("active")}}}),app.Views.ContactPage=Backbone.View.extend({el:".contact-wrapper",events:{},initialize:function(){this.createMap()},createMap:function(){var e=this.$el.find(".contact-map");if(0!==e.length){var t=e[0],i=new google.maps.Geocoder,n=e.attr("data-location"),a={mapTypeId:google.maps.MapTypeId.ROADMAP,zoom:15};this.map=new google.maps.Map(t,a);var o=[{stylers:[{hue:"#f1e9db"},{lightness:42}]},{featureType:"water",elementType:"all",stylers:[{color:"#d7c7a6"}]}];this.map.setOptions({styles:o}),i.geocode({address:n},_.bind(function(e,t){if(t==google.maps.GeocoderStatus.OK){this.map.setCenter(e[0].geometry.location);new google.maps.Marker({map:this.map,position:e[0].geometry.location})}},this))}}}),app.Views.NewsListPage=Backbone.View.extend({el:"#content",events:{"click .news-list-more-btn":"loadMoreNews"},$newsLoader:null,$newsItemWrapper:null,newsLoadInProgress:!1,nextPage:0,postsPerPage:6,standardNewsCount:0,standardNewsLoaded:0,template:null,initialize:function(){this.template=_.template(e("#news-item-template").html()),this.$newsLoader=this.$el.find(".news-list-loading-cover"),this.$newsItemWrapper=this.$el.find(".news-list-item-wrapper"),this.standardNewsCount=this.$newsItemWrapper.attr("data-standard-news-count"),this.loadMoreNews()},loadMoreNews:function(){var t=this;if(this.newsLoadInProgress!==!0){this.newsLoadInProgress=!0,tween.to(this.$newsLoader,.4,{autoAlpha:1});var i={action:"dfs-get-news",posts_per_page:this.postsPerPage,page:this.nextPage};e.ajax({dataType:"json",url:"/wp-admin/admin-ajax.php",data:i,success:function(e){t.standardNewsLoaded=t.standardNewsLoaded+t.postsPerPage,t.standardNewsLoaded>=t.standardNewsCount&&t.$el.find(".news-list-more-btn").hide(),_.each(e,function(e,i){t.$newsItemWrapper.append(t.template(e))}),t.nextPage++,tween.to(t.$newsLoader,.4,{autoAlpha:0}),t.newsLoadInProgress=!1}}).error(function(e){t.newsLoadInProgress=!1,console.log("back end error"),console.log(e),tween.to(t.$newsLoader,.4,{autoAlpha:0}),t.$el.find(".news-list-more-btn").hide()})}}}),app.Views.RegistrationPage=Backbone.View.extend({el:"#registration-wrapper",initialize:function(){this.listenTo(app,"dfs-register-full-success",_.bind(function(e){window.location.replace("/")},this))}}),app.Views.RegisterForm=Backbone.View.extend({el:"#register-and-meta-wrapper",validation:null,data:null,events:{"click .registration-submit":"prepareForSubmit","keydown .form-fields :input":"fieldKeydown"},initialize:function(e){gaplusu("send","event","Donation",app.registrationSteps[0],null,1),this.$el.find(".sign-in-link").on("click",app.views.header.openSignInOverlay),this.listenTo(app,"dfs-register-check-success",_.bind(function(e){e.hideLoader(),app.views.MultiForm.nextPage(),this.$el.find("#reg-first-name").val(e.data["reg-check-first-name"]),this.$el.find("#reg-last-name").val(e.data["reg-check-last-name"]),this.$el.find("#reg-email").val(e.data["reg-check-email"])},this))}}),app.Views.MultiForm=Backbone.View.extend({el:".multi-form-wrapper",$forms:null,$progressBarItems:null,currentForm:0,initialize:function(){this.$forms=this.$el.find(".multi-form-page");var e=this.$el.find(".multi-form-progress-bar");if(e.length>0){var t=e.find(".multi-form-progress-bar-list > li");t.length===this.$forms.length?this.$progressBarItems=t:e.hide()}this.showForm(0)},nextPage:function(){var t=this.currentForm+1;e("#donation-wrapper").length>0&&gaplusu("send","event","Donation",app.registrationSteps[t],null,1),this.showForm(t)},prevPage:function(){this.showForm(this.currentForm-1)},showForm:function(e){if(e!==this.currentForm){var t=this.$forms.eq(this.currentForm);tween.to(t,.4,{autoAlpha:0,height:0}),this.currentForm=e}null!==this.$progressBarItems&&this.$progressBarItems.removeClass("active").eq(e).addClass("active");var i=this.$forms.eq(e),n=i.find(".multi-form-height-holder").outerHeight();tween.to(i,.4,{autoAlpha:1,height:n,onComplete:function(){i.css("height","auto")}}),e>0&&setTimeout(function(){i.find(":input").first().focus()},100)}}),app.Views.CaptchaAjax=Backbone.View.extend({el:null,captchaAction:null,captchaPublicKey:null,data:null,fieldValidationEnabled:!0,validation:null,initialize:function(e){_.extend(this,_.pick(e,"el")),_.extend(this,_.pick(e,"captchaAction")),_.extend(this,_.pick(e,"captchaPublicKey")),_.extend(this,_.pick(e,"data")),this.data.action="dfs-captcha-ajax","undefined"!=typeof e.fieldValidationEnabled&&null!==e.fieldValidationEnabled&&_.extend(this,_.pick(e,"fieldValidationEnabled")),this.fieldValidationEnabled&&(this.validation=new SmoothValidator(this.$el))},showLoader:function(){var e=this.$el.find(".loading-cover");tween.set(e.find("> img"),{autoAlpha:1}),tween.to(e,.4,{css:{autoAlpha:.8}})},hideLoader:function(){tween.to(this.$el.find(".loading-cover"),.4,{css:{autoAlpha:0}})},validate:function(t){var i=this;this.showLoader(),grecaptcha.ready(function(){grecaptcha.execute(i.captchaPublicKey,{action:i.captchaAction}).then(function(t){i.data["g-recaptcha-response"]=t,e.post("/wp-admin/admin-ajax.php",i.data,function(e){e.success?app.trigger("dfs-captcha-ajax-success",i):(app.trigger("dfs-captcha-ajax-error",i),i.fieldValidationEnabled&&("undefined"!=typeof e.errors?i.validation.renderValidationErrors(e.errors):(i.validation.renderValidationErrors({general:"There was an error processing your submission.  Please try again."}),console.log(e))))}).error(function(e){app.trigger("dfs-captcha-ajax-error",i),i.hideLoader(),i.fieldValidationEnabled&&(i.validation.renderValidationErrors({general:"There was an error processing your submission.  Please try again."}),console.log("Unexpected back-end error:"),console.log(e))})})})}}),app.Views.CaptchaForm=Backbone.View.extend({el:null,captchaAction:null,events:{submit:"validateForm"},initialize:function(t){e(".em-booking-form").off(),_.extend(this,_.pick(t,"el")),_.extend(this,_.pick(t,"captchaAction")),_.extend(this,_.pick(t,"captchaPublicKey")),_.extend(this,_.pick(t,"captchaTag")),this.listenTo(app,"dfs-captcha-ajax-success",_.bind(function(e){e.$el[0].submit()},this))},validateForm:function(t){t.preventDefault();var i={"captcha-tag":e(this.captchaTag).val(),"captcha-action":this.captchaAction},n={el:this.el,captchaAction:this.captchaAction,captchaPublicKey:this.captchaPublicKey,fieldValidationEnabled:!1,data:i},a=new app.Views.CaptchaAjax(n);a.validate()}}),app.Views.AjaxForm=Backbone.View.extend({ajaxInProgress:!1,validation:null,lastResponse:null,data:null,events:{"click .form-submit":"prepareForSubmit","keydown .form-fields :input":"fieldKeydown","click .form-confirm-confirm-btn":"confirmConfirmModal","click .form-confirm-modal-wrapper":"onConfirmWrapperClick"},initialize:function(e){this.validation=new SmoothValidator(this.$el),_.extend(this,_.pick(e,"ajaxAction")),_.extend(this,_.pick(e,"captchaAction")),_.extend(this,_.pick(e,"captchaPublicKey"))},fieldKeydown:function(e){"textarea"!==e.currentTarget.nodeName.toLowerCase()&&13===e.keyCode&&this.ajaxInProgress===!1&&this.prepareForSubmit()},showLoader:function(){var e=this.$el.find(".loading-cover");tween.set(e.find("> img"),{autoAlpha:1}),tween.to(e,.4,{css:{autoAlpha:.8}})},hideLoader:function(){tween.to(this.$el.find(".loading-cover"),.4,{css:{autoAlpha:0}})},onConfirmWrapperClick:function(t){var i=e(t.target);(i.hasClass("form-confirm-modal-wrapper")||i.hasClass("form-confirm-cancel-btn"))&&this.closeConfirmModal()},closeConfirmModal:function(){var e=this.$el.find(".form-confirm-modal-wrapper");tween.to(e,.4,{autoAlpha:0})},confirmConfirmModal:function(e){e.stopPropagation(),this.closeConfirmModal(),this.captchaAction?this.submitToCaptchaEndpoint():this.submitToEndpoint()},prepareForSubmit:function(){var e=this.$el.find(".form-fields");if(this.data=this.validation.validateAndBuildData(e),null!==this.data){var t=this.$el.find(".form-confirm-modal-wrapper");t.length>0?tween.to(t,.4,{autoAlpha:1}):this.captchaAction?this.submitToCaptchaEndpoint():this.submitToEndpoint()}},submitToCaptchaEndpoint:function(){var t=this;null!==this.data&&t.ajaxInProgress===!1&&(this.data.action=t.ajaxAction,t.ajaxInProgress=!0,this.showLoader(),grecaptcha.ready(function(){grecaptcha.execute(t.captchaPublicKey,{action:t.captchaAction}).then(function(i){t.data["g-recaptcha-response"]=i,e.post("/wp-admin/admin-ajax.php",t.data,function(e){t.ajaxInProgress=!1,t.lastResponse=e,e.success?app.trigger(t.ajaxAction+"-success",t):(t.hideLoader(),app.trigger(t.ajaxAction+"-error",t),"undefined"!=typeof e.errors?t.validation.renderValidationErrors(e.errors):(t.validation.renderValidationErrors({general:"There was an error processing your submission.  Please try again."}),console.log(e)))}).error(function(e){app.trigger(t.ajaxAction+"-error",t),t.ajaxInProgress=!1,t.hideLoader(),t.validation.renderValidationErrors({general:"There was an error processing your submission.  Please try again."}),console.log("Unexpected back-end error:"),console.log(e)})})}))},submitToEndpoint:function(){var t=this;null!==this.data&&t.ajaxInProgress===!1&&(this.data.action=t.ajaxAction,t.ajaxInProgress=!0,t.showLoader(),e.post("/wp-admin/admin-ajax.php",this.data,function(e){t.ajaxInProgress=!1,t.lastResponse=e,"undefined"!=typeof e.success&&"true"===e.success?app.trigger(t.ajaxAction+"-success",t):(t.hideLoader(),app.trigger(t.ajaxAction+"-error",t),"undefined"!=typeof e.errors?t.validation.renderValidationErrors(e.errors):(t.validation.renderValidationErrors({general:"There was an error processing your submission.  Please try again."}),console.log(e)))}).error(function(e){app.trigger(t.ajaxAction+"-error",t),t.ajaxInProgress=!1,t.hideLoader(),t.validation.renderValidationErrors({general:"There was an error processing your submission.  Please try again."}),console.log("Unexpected back-end error:"),console.log(e)}))}}),app.Views.VolunteerForm=Backbone.View.extend({el:".volunteer-form-content",events:{},initialize:function(){this.listenTo(app,"dfs-register-full-success",_.bind(function(e){e.hideLoader(),app.views.MultiForm.nextPage(),this.updateAddressInfo(e)},this)),this.listenTo(app,"dfs-volunteer-success",_.bind(function(e){var t=app.registrationSteps[app.registrationSteps.length-1];gaplusu("send","event","Donation",t,null,1),window.location.href="/get-involved/volunteer/thank-you"},this))},updateAddressInfo:function(e){var t=e.data;this.$el.find("#volunteer-first-name").val(t["reg-first-name"]),this.$el.find("#volunteer-last-name").val(t["reg-last-name"]),this.$el.find("#volunteer-email").val(t["reg-email"]),this.$el.find("#volunteer-address-1").val(t["reg-address"]),this.$el.find("#volunteer-address-2").val(t["reg-address-2"]),this.$el.find("#volunteer-city").val(t["reg-city"]),this.$el.find("#volunteer-state").val(t["reg-state"]),this.$el.find("#volunteer-zip").val(t["reg-zip"]),this.$el.find("#volunteer-country").val(t["reg-country"]),this.$el.find("#volunteer-phone").val(t["reg-phone"])}}),app.Views.AccountForm=Backbone.View.extend({el:"#account-address-form",events:{},initialize:function(){this.listenTo(app,"dfs-account-address-success",_.bind(this.onAddressUpdated,this))},onAddressUpdated:function(e){var t=this.$el.find(".account-success-message"),i=this.$el.find(".loading-cover > img");tween.to(i,.4,{autoAlpha:0}),tween.to(t,.4,{autoAlpha:1,onComplete:function(){setTimeout(function(){tween.to(t,.4,{autoAlpha:0}),e.hideLoader()},2e3)}})}}),app.Views.DonateHeader=Backbone.View.extend({el:".donate-head-text",events:{"click .donate-money-btn":"onDonateMoneyClick","click .donate-clothes-btn":"onDonateClothesClick"},initialize:function(){this.$moneyArea=e("#donation-wrapper"),this.$clothesArea=e(".donate-clothes-instructions")},onDonateMoneyClick:function(){var t=this.$moneyArea.offset().top;tween.to(e("html, body"),1,{scrollTop:t})},onDonateClothesClick:function(){var t=this.$clothesArea.offset().top;tween.to(e("html, body"),1.6,{scrollTop:t})}}),app.Views.DonationForm=Backbone.View.extend({el:"#donation-form",$donateSchedule:null,$donateRadio:null,events:{"click #donation-suggestions li":"donationSuggestionClick","click #donate-type-once":"hideDonateSchedule","click #donate-type-recurring":"showDonateSchedule","focus #donate-other-amount":"focusOtherAmount","click .donate-currency-tooltip-wrapper":"showCurrencyTooltip","click .donate-currency-tooltip-close":"hideCurrencyTooltip"},initialize:function(e){_.extend(this,_.pick(e,"currencyCode")),this.validation=new SmoothValidator(this.$el),this.$donateRadio=this.$el.find("#donate-amount"),this.$donateRadio.on("change","input",_.bind(this.donateAmountChange,this));var t=sessionStorage.getItem("donation-amount");null!==t&&(this.$donateRadio.find("#donate-amount-other").prop("checked",!0).siblings().prop("checked",!1),this.$el.find("#donate-other-amount").val(t),this.performCurrencyConversion(t)),this.$donateSchedule=this.$el.find("#donate-schedule"),this.listenTo(app,"dfs-register-full-success",_.bind(function(e){e.hideLoader(),app.views.MultiForm.nextPage(),this.updateAddressInfo(e)},this)),this.listenTo(app,"dfs-donate-success",_.bind(function(e){window.location.href="/get-involved/donate/thank-you"},this)),this.listenTo(app,"dfs-donate-worldwide-success",_.bind(function(e){window.location.href="/get-involved/donate/thank-you"},this))},updateAddressInfo:function(e){var t=e.data;this.$el.find("#donate-first-name").val(t["reg-first-name"]),this.$el.find("#donate-last-name").val(t["reg-last-name"]),this.$el.find("#donate-email").val(t["reg-email"]),this.$el.find("#donate-street-1").val(t["reg-address"]),this.$el.find("#donate-street-2").val(t["reg-address-2"]),this.$el.find("#donate-city").val(t["reg-city"]),this.$el.find("#donate-state").val(t["reg-state"]),this.$el.find("#donate-zip").val(t["reg-zip"]),this.$el.find("#donate-country").val(t["reg-country"])},donateAmountChange:function(t){var i=(e(t.currentTarget),this.$donateRadio.find(":checked")),n=this.$donateRadio.find("#donate-other-amount"),a=i.val();if("donate-other-amount"===t.currentTarget.id){var o=n.val();null!==o.match(/^[+-]?[0-9]{1,3}(?:,?[0-9]{3})*(?:\.[0-9]{2})?$/)&&this.performCurrencyConversion(n.val())}else"other"===a?(n.attr("data-v-required",""),n.focus()):(n.removeAttr("data-v-required").val(""),this.performCurrencyConversion(a))},performCurrencyConversion:function(t){var i=t.replace(/./g,function(e,t,i){return t&&"."!==e&&(i.length-t)%3===0?","+e:e});if("USD"!==this.currencyCode){var n="https://openexchangerates.org/api/convert",a="USD",o=this.currencyCode,s=n+"/"+t+"/"+a+"/"+o+"?app_id=fa95bd100a314476830e8761f7ba3f60",l=this;e.getJSON(s,function(e){var t=e.response,n=t.toFixed(2)+" "+o,a="$"+i+" converts to "+n;l.$el.find(".donate-currency-conversion").text(a).show(),l.$el.find(".donate-confirm-conversion-label").text("For donors outside of the US, the value of your contribution of $"+i+" USD is "+n+"."),l.$el.find("#donate-amount-converted").val(n)}).fail(function(e){console.log(e.responseText),l.$el.find(".donate-confirm-conversion-label").text(""),l.$el.find(".donate-currency-conversion").hide()})}},focusOtherAmount:function(t){var i=e(t.currentTarget);i.removeClass("grayed").attr("data-v-required",""),this.$donateRadio.find("#donate-amount-other").prop("checked",!0).siblings(":checked").prop("checked",!1)},hideDonateSchedule:function(){tween.to(this.$donateSchedule,.5,{height:0})},showDonateSchedule:function(){var e=this.$donateSchedule.find(".donate-schedule-height-holder"),t=e.outerHeight();tween.to(this.$donateSchedule,.5,{height:t})},donationSuggestionClick:function(t){var i=e(t.currentTarget),n=i.text().substr(1);this.$el.find("#donate-donation-amount").val(n).trigger("change")},showCurrencyTooltip:function(){var e=this.$el.find(".donate-currency-tooltip");tween.to(e,.4,{autoAlpha:1})},hideCurrencyTooltip:function(e){e.stopPropagation();var t=this.$el.find(".donate-currency-tooltip");tween.to(t,.4,{autoAlpha:0})}}),app.Views.DonateLocationMap=Backbone.View.extend({el:".donate-locations-and-hours",events:{},initialize:function(){this.createLocationMap()},createLocationMap:function(){var e=this.$el.find(".donate-locations-map");if(0!==e.length)for(var t=[],i=0;i<e.length;i++){var n=e[i],a=new google.maps.Geocoder,o=e.eq(i).attr("data-location"),s={mapTypeId:google.maps.MapTypeId.ROADMAP,zoom:15};t[i]=new google.maps.Map(n,s);var l=[{stylers:[{hue:"#f1e9db"},{lightness:42}]},{featureType:"water",elementType:"all",stylers:[{color:"#d7c7a6"}]}];t[i].setOptions({styles:l}),a.geocode({address:o},_.partial(function(i,n,a){if(n==google.maps.GeocoderStatus.OK){t[a].setCenter(i[0].geometry.location);new google.maps.Marker({map:t[a],position:i[0].geometry.location})}else e.eq(a).hide()},_,_,i))}}}),app.Views.Footer=Backbone.View.extend({el:"footer",events:{"click #footer-join-newsletter":"openNewsletterOverlay","click #gdpr-modal-accept":"footerModalAccept","click #gdpr-modal-dismiss":"footerModalDismiss"},$newsletterOverlay:null,initialize:function(){this.$newsletterOverlay=this.$el.find("#newsletter-form-overlay");var t=getCookie("gdpr-notice");t||e("#gdpr-notice").fadeIn()},createNewsletterAjaxForm:_.once(function(){app.views.footer.newsletterAjaxForm=new app.Views.AjaxForm({el:"#newsletter-form",ajaxAction:"dfs-newsletter-sign-up"}),app.views.footer.listenTo(app,"dfs-newsletter-sign-up-success",this.finishOverlay)}),finishOverlay:function(){var e=this,t=this.$newsletterOverlay.find("#newsletter-modal-content"),i=this.$newsletterOverlay.find("#newsletter-thank-you");tween.to(t,.6,{autoAlpha:0}),tween.to(i,.6,{autoAlpha:1,onComplete:function(){setTimeout(function(){tween.to(e.$newsletterOverlay,.6,{autoAlpha:0,onComplete:function(){tween.set(i,{autoAlpha:0}),tween.set(t,{autoAlpha:1}),app.views.footer.newsletterAjaxForm.hideLoader()}})},3e3)}})},footerModalAccept:function(){setCookie("gdpr-notice","1",7300),e("#gdpr-notice").fadeOut(function(){e("#gdpr-notice").css("display","none")})},footerModalDismiss:function(){e("#gdpr-notice").fadeOut(function(){e("#gdpr-notice").css("display","none")})},openNewsletterOverlay:function(e){e.preventDefault(),this.createNewsletterAjaxForm(),tween.to(app.views.footer.$newsletterOverlay,.4,{autoAlpha:1,onComplete:function(){app.views.footer.$newsletterOverlay.find("#newsletter-first-name").focus()}}),app.views.footer.$newsletterOverlay.on("click",function(e){var t=e.target.id;"newsletter-form-overlay"!==t&&"newsletter-close-x"!==t||app.views.footer.closeNewsletterOverlay()})},closeNewsletterOverlay:function(){tween.to(this.$newsletterOverlay,.4,{autoAlpha:0}),this.$newsletterOverlay.off("click");
}}),app.Views.Header=Backbone.View.extend({el:"header",events:{"click .nav-mobile-btn":"mobileNavToggle","click #black-overlay":"mobileNavToggle","click .top-nav > li > a":"topNavItemClick","click .sub-menu-back":"closeSubMenu","click .nav-mobile-affiliate-btn":"openAffilMenu","click .affil-select-mobile-back-btn":"closeAffilMenu","click #affil-select-mobile > ul > li":"openAffilLocation","click #sign-in-btn":"openSignInOverlay","click #sub-menu-title-sign-in.signed-out":"openSignInOverlay"},$overlay:null,$nav:null,$mobileBtn:null,$affilMenu:null,$signInOverlay:null,affilMenuButtonsHeight:0,initialize:function(){this.$nav=this.$el.find("nav"),this.$overlay=e("#black-overlay"),this.$mobileBtn=this.$el.find(".nav-mobile-btn"),this.$affilMenu=this.$el.find("#affil-select-mobile"),this.$signInOverlay=e("#sign-in-form-overlay");var t=this.$el.find(".affil-select-mobile-back-btn").outerHeight(),i=this.$el.find(".affil-select-mobile-current-location").outerHeight();this.affilMenuButtonsHeight=t+i;var n=_.debounce(this.resizeMobileNav,250);e(window).on("resize",_.bind(n,this))},resizeMobileNav:function(){var t=this.$nav.find(".nav-mobile-only").first();if(t.is(":visible")&&this.$nav.hasClass("open")){var i=this.$el.find(".header-main-row").outerHeight(),n=e("body").outerHeight()-i;tween.set(this.$nav,{height:n,top:i})}else tween.set(this.$nav,{height:"auto"})},mobileNavToggle:function(){this.$nav.hasClass("open")?(tween.to(this.$overlay,.4,{autoAlpha:0}),this.$nav.removeClass("open")):(tween.to(this.$overlay,.4,{autoAlpha:1}),this.$nav.addClass("open"),this.resizeMobileNav())},topNavItemClick:function(t){if(this.$mobileBtn.is(":visible")){var i=e(t.currentTarget),n=i.attr("data-id"),a=this.$el.find("#sub-menu-"+n);if(0===a.length){var o=i.attr("data-title").split(" ").join("-").toLowerCase();a=this.$el.find("#sub-menu-"+o)}a.length>0&&(t.preventDefault(),tween.to(a,.4,{autoAlpha:1}))}},closeSubMenu:function(t){var i=e(t.currentTarget),n=i.closest(".sub-menu");tween.to(n,.4,{autoAlpha:0})},openAffilMenu:function(){var e=this.$affilMenu.find('[data-list="level-1"]');e.siblings("ul");this.$affilMenu.removeClass("level-3").removeClass("level-2"),this.$affilMenu.find("affil-select-mobile-current-location").text("COUNTRY"),this.$affilMenu.addClass("open")},closeAffilMenu:function(){if(this.$affilMenu.hasClass("level-3")){this.$affilMenu.removeClass("level-3");var e=this.$affilMenu.find(".affil-select-mobile-current-location"),t=e.attr("data-lastLocationName");e.text(t)}else this.$affilMenu.hasClass("level-2")?(this.$affilMenu.removeClass("level-2"),this.$affilMenu.find(".affil-select-mobile-current-location").text("Country")):this.$affilMenu.removeClass("open")},openAffilLocation:function(t){var i=e(t.currentTarget);if(0===i.find("a").length){var n=i.parent().attr("data-child-list"),a=i.attr("data-Id"),o=i.text(),s=this.$affilMenu.find('> ul[data-list="'+n+'"]');s.find("li").hide().filter('[data-childOf="'+a+'"]').show();var l=this.$affilMenu.find(".affil-select-mobile-current-location");l.attr("data-lastLocationName",l.text()).text(o),this.$affilMenu.addClass(n)}},openSignInOverlay:function(){tween.to(app.views.header.$signInOverlay,.4,{autoAlpha:1,onComplete:function(){app.views.header.$signInOverlay.find("#user_login").focus()}}),app.views.header.$signInOverlay.on("click",function(e){var t=e.target.id;"sign-in-form-overlay"!==t&&"sign-in-close-x"!==t||app.views.header.closeSignInOverlay()})},closeSignInOverlay:function(){tween.to(this.$signInOverlay,.4,{autoAlpha:0}),this.$signInOverlay.off("click")}}),app.Views.AffiliateDropDown=Backbone.View.extend({el:"#affiliate-selection-overlay",$activeList:null,$listArea:null,$nav:null,events:{"click .affil-select-instance-list li":"locationClick","click .affil-select-nav-bar > ul > li":"navLocationClick","click .affil-select-close":"unrender",click:"overlayClick","click .affil-select-btn":"unrender"},initialize:function(){this.$listArea=this.$el.find(".affil-select-instance-list"),this.$nav=this.$el.find(".affil-select-nav-bar ul"),e(".header .affil-select-btn").on("click",function(){app.views.affiliateDropDown.render()}),this.goToList("level-1","International","origin")},render:function(){tween.to(this.$el,.3,{css:{autoAlpha:1}})},unrender:function(){tween.to(this.$el,.3,{css:{autoAlpha:0},onComplete:function(){app.views.affiliateDropDown.goToList("level-1","International","origin")}})},overlayClick:function(e){var t=e.target;"affiliate-selection-overlay"===t.id&&app.views.affiliateDropDown.unrender()},navLocationClick:function(t){var i=e(t.currentTarget),n=i.attr("data-Id"),a=i.attr("data-childListLevel"),o=i.text();this.goToList(a,o,n)},addNavItem:function(t,i,n){var a='<li data-childListLevel="'+t+'" ';a+='data-Id="'+n+'"><div>',a+=i+"</div></li>";var o=e(a);this.$nav.append(o);var s=o.outerWidth();o.css({width:"0px",visibility:"hidden"}),tween.to(o,.3,{css:{width:s},onComplete:function(){tween.to(o,.3,{css:{autoAlpha:1}})}})},removeNavItem:function(e){tween.to(e,.3,{css:{autoAlpha:0},onComplete:function(){tween.to(e,.3,{css:{width:0},onComplete:function(){setTimeout(function(){e.remove()},0)}})}})},locationClick:function(t){var i=e(t.currentTarget);if(0===i.find("a").length){var n=i.parent().attr("data-child-list"),a=i.attr("data-Id"),o=i.text();this.goToList(n,o,a)}},goToList:function(e,t,i){var n=this.$el.find(".affil-select-instance-list > ul[data-list="+e+"]"),a=null===this.$activeList?null:this.$activeList[0];if(n[0]!==a){if("origin"===i)n.find("li").css({display:"inline-block"});else{var o=n.find("[data-ChildOf="+i+"]");o.css({display:"inline-block"})}var s=this.$nav.find("li[data-Id="+i+"]");0===s.length?this.addNavItem(e,t,i):this.removeNavItem(s.nextAll()),this.animateListChange(n)}},animateListChange:function(e){var t=e.outerHeight();null!==this.$activeList&&tween.to(this.$activeList,.3,{css:{autoAlpha:0},onComplete:function(){app.views.affiliateDropDown.$activeList.find("li").hide()}}),tween.to(this.$listArea,.3,{css:{height:t},onComplete:function(){tween.to(e,.3,{css:{autoAlpha:1}}),app.views.affiliateDropDown.$activeList=e}})}})}(jQuery),function(e){"use strict";app.Views.HomeEventsModule=Backbone.View.extend({el:".home-events-module",events:{},resizeAttempts:0,initialize:function(){var t=this.$el.find(".home-event-image img"),i=t.attr("data-src");t.prop("src",i),t.on("load",_.bind(function(){var t=_.debounce(this.resizeTwitter,250);e(window).on("resize",_.bind(t,this)),this.setInitialTwitterSize()},this))},setInitialTwitterSize:function(){var e=this.$el.find("#twitter-widget-0");0===e.length&&this.resizeAttempts<40?(this.resizeAttempts++,setTimeout(_.bind(this.setInitialTwitterSize,this),500)):setTimeout(_.bind(this.resizeTwitter,this),800)},resizeTwitter:function(){var e=this.$el.find(".home-event-image img"),t=e.outerHeight(),i=this.$el.find(".home-event-details").outerHeight(),n=this.$el.find("#twitter-widget-0"),a=t>i?t:i;a<200&&(a=200),tween.set(n,{height:a,width:"100%"})}}),app.Views.StartAffiliateModule=Backbone.View.extend({el:"#inner-content",affiliateModal:e("#affiliate-modal"),events:{"click #affiliate-form-modal":"showAffiliateModal","click #affiliate-form-submit":"submitAffiliateForm","keydown #interest":"enforceCharacterLimit"},initialize:function(e){_.extend(this,_.pick(e,"ajaxAction"))},enforceCharacterLimit:function(){var t=parseInt(e("#interest").val().length),i=500-t;if(e("#character-limit").text(i),i<=0){var n=e("#interest").val().substring(0,500);e("#interest").val(n)}},showAffiliateModal:function(e){e.preventDefault(),tween.to(this.affiliateModal,.4,{autoAlpha:1}),this.affiliateModal.on("click",function(e){var t=e.target.id;"affiliate-modal"!==t&&"affiliate-modal-close"!==t||tween.to(this,.4,{autoAlpha:0})})},submitAffiliateForm:function(){var t=this;if(e("#incomplete-blurb").addClass("hidden"),e("#error-blurb").addClass("hidden"),e(".field-invalid").removeClass("field-invalid"),e("#contactApproval").is(":checked")||e("#contactApproval").closest(".checkbox-container").addClass("field-invalid"),e("#gdprApproval").is(":checked")||e("#gdprApproval").closest(".checkbox-container").addClass("field-invalid"),e("#firstName").val()||e("#firstName").addClass("field-invalid"),e("#lastName").val()||e("#lastName").addClass("field-invalid"),e("#email").val()||e("#email").addClass("field-invalid"),e("#country").val()||e("#country").addClass("field-invalid"),e(".field-invalid").length)return void e("#incomplete-blurb").removeClass("hidden");var i={firstName:e("#firstName").val(),lastName:e("#lastName").val(),email:e("#email").val(),city:e("#city").val(),state:e("#state").val(),country:e("#country").val(),interest:e("#interest").val(),action:this.ajaxAction};e.ajax({dataType:"json",url:"/wp-admin/admin-ajax.php",data:i,type:"post",cache:!1,beforeSend:function(){tween.to(e("#affiliate-form-container"),.4,{autoAlpha:.3}),e("#affiliate-modal-loader").removeClass("hidden")},success:function(i){"true"==i.success?(tween.to(t.affiliateModal,.4,{autoAlpha:0}),e("#affiliate-confirmation").removeClass("hidden"),tween.set(e("#affiliate-form-container"),{display:"none",delay:.4}),tween.set(e(".affiliate-modal-content"),{height:"auto",delay:.4}),tween.set(e(".affiliate-modal-content"),{height:"auto",delay:.4}),tween.to(t.affiliateModal,.4,{autoAlpha:1,delay:.4})):(tween.to(e("#affiliate-form-container"),.4,{autoAlpha:1}),e("#error-blurb").removeClass("hidden"),e("#error-blurb").text(i.error))},complete:function(){e("#affiliate-modal-loader").addClass("hidden")}}).error(function(e){console.log("error"),console.log(e)})}}),app.Views.FriendsModule=Backbone.View.extend({el:".friends-module",$pageWrapper:null,$pages:null,$controls:null,$activePage:null,events:{"click .circle-page-controls > li":"controlsClick"},initialize:function(){if(this.$pageWrapper=this.$el.find(".friends-list-wrapper"),this.$pages=this.$el.find(".friends-list"),this.$controls=this.$el.find(".circle-page-controls"),this.$pages.length>1){for(var e="",t=0;t<this.$pages.length;t++)e+="<li></li>";this.$controls.html(e),this.$el.on("swipeleft",_.bind(this.nextPage,this)),this.$el.on("swiperight",_.bind(this.prevPage,this))}else this.$controls.hide();this.showPage(0)},nextPage:function(){var e=this.$activePage.index()+1;this.showPage(e)},prevPage:function(){var e=this.$activePage.index()-1;this.showPage(e)},controlsClick:function(t){var i=e(t.currentTarget);this.showPage(i.index())},showPage:function(e){if(e<this.$pages.length&&e>=0){var t=this.$pages.eq(e),i=this.$controls.find("li").eq(e);if(null!==this.$activePage){var n=this.$activePage;tween.to(this.$activePage,.4,{css:{autoAlpha:0},onComplete:function(){n.hide(),t.show(),tween.to(t,.4,{css:{autoAlpha:1}})}})}else t.show(),tween.to(t,.4,{css:{autoAlpha:1}});i.addClass("active").siblings().removeClass("active"),this.$activePage=t}}}),app.Views.ProgramsModule=Backbone.View.extend({el:".programs-module",$pageWrapper:null,$pages:null,$controls:null,$activePage:null,events:{"click .circle-page-controls > li":"controlsClick"},initialize:function(){if(this.$pageWrapper=this.$el.find(".programs-module-pages-wrapper"),this.$pages=this.$el.find(".programs-module-page"),this.$controls=this.$el.find(".circle-page-controls"),this.$pages.length>1){for(var t="",i=0;i<this.$pages.length;i++)t+="<li></li>";this.$controls.html(t)}else this.$controls.hide();this.showPage(0);var n=_.debounce(this.resizeWrapper,250);e(window).on("resize",_.bind(n,this)),this.$el.on("swipeleft",_.bind(this.nextPage,this)),this.$el.on("swiperight",_.bind(this.prevPage,this))},nextPage:function(){var e=this.$activePage.index()+1;this.showPage(e,!0)},prevPage:function(){var e=this.$activePage.index()-1;this.showPage(e,!0)},resizeWrapper:function(){null!==this.$activePage&&tween.to(this.$pageWrapper,.4,{height:this.$activePage.outerHeight()})},controlsClick:function(t){var i=e(t.currentTarget);this.showPage(i.index(),!0)},showPage:function(t,i){if("undefined"==typeof i&&(i=!1),t>=0&&t<this.$pages.length){var n=this.$pages.eq(t),a=this.$controls.find("li").eq(t);i&&tween.to(e("html, body"),1,{scrollTop:this.$el.offset().top-20}),null!==this.$activePage&&tween.to(this.$activePage,.4,{autoAlpha:0}),tween.to(n,.4,{autoAlpha:1}),tween.to(this.$pageWrapper,.4,{height:n.outerHeight()}),a.addClass("active").siblings().removeClass("active"),this.$activePage=n}}}),app.Views.GalleryModule=Backbone.View.extend({el:".gallery-module",events:{},initialize:function(){var e=this.$el.find(".gallery-image-wrapper").length,t=6,i=4,n=2;t=e<t?e:t,i=e<i?e:i,n=e<n?e:n,this.$el.find("#gallery-slick").slick({dots:!0,infinite:!0,slidesToShow:t,slidesToScroll:t,arrows:!1,autoplay:!0,autoplaySpeed:7e3,responsive:[{breakpoint:1024,settings:{slidesToShow:i,slidesToScroll:i}},{breakpoint:768,settings:{slidesToShow:n,slidesToScroll:n,arrows:!0,dots:!1}}]}),this.$el.find(".gallery-image-wrapper").fancybox({maxWidth:768,arrows:!0})}}),app.Views.DonateModule=Backbone.View.extend({el:".donate-module",events:{"click .donate-money-submit":"donateMoneyClick","keyup .donate-money-amount":"donateMoneyKeyup"},initialize:function(){},donateMoneyClick:function(){var e=this.$el.find(".donate-money-amount").val();isNaN(e)===!1&&sessionStorage.setItem("donation-amount",e),window.location="/donate"},donateMoneyKeyup:function(e){13===e.keyCode&&this.donateMoneyClick()}}),app.Views.AffiliateMapModule=Backbone.View.extend({el:"#affiliate-map-canvas",map:null,openInfoWindow:null,callToActionVisible:!0,initialize:function(){this.initGoogleMap(),this.loadAffiliateMarkers()},initGoogleMap:function(){var e=this.el,t={center:new google.maps.LatLng(25,(-10)),mapTypeId:google.maps.MapTypeId.ROADMAP,disableDefaultUI:!0,zoomControl:!0,zoomControlOptions:{position:google.maps.ControlPosition.LEFT_TOP},minZoom:2,maxZoom:13,zoom:3,scrollwheel:!1};this.map=new google.maps.Map(e,t);var i=new google.maps.LatLngBounds(new google.maps.LatLng((-50),(-140)),new google.maps.LatLng(50,140)),n=this.map.getCenter();google.maps.event.addListener(this.map,"click",_.bind(this.mapClicked,this)),google.maps.event.addListener(this.map,"zoom_changed",_.bind(this.zoomChanged,this)),google.maps.event.addListener(this.map,"center_changed",_.bind(function(){return i.contains(this.map.getCenter())?void(n=this.map.getCenter()):void this.map.panTo(n)},this));var a=[{stylers:[{hue:"#f1e9db"},{lightness:42}]},{elementType:"labels.text",stylers:[{visibility:"off"}]},{featureType:"administrative",stylers:[{visibility:"off"}]},{featureType:"water",elementType:"all",stylers:[{color:"#d7c7a6"}]},{featureType:"road",elementType:"geometry",stylers:[{visibility:"simplified"}]}];this.map.setOptions({styles:a})},loadAffiliateMarkers:function(){var t=this,i={action:"dfs-get-map-affils"};e.post("/wp-admin/admin-ajax.php",i,_.bind(function(i){var n=this;e.each(i.affils,function(e,i){if("undefined"!=typeof i.coordinates){var a=new google.maps.LatLng(i.coordinates.lat,i.coordinates.lng),o=new google.maps.Marker({position:a,map:n.map,title:i.title,icon:"/wp-content/themes/dfs/library/images/google-maps-pin"+("true"===i.isTarget?"-red":"")+".png"}),s='<div style="white-space: nowrap; overflow: auto;">';s+='<div style="text-align: center; font-size: 23px; line-height: 37px;">',"true"===i.isTarget?(s+='<a href="/about-us/start-an-affiliate/">'+i.title+"</a></div>",s+='<div style="text-align: center; font-size: 15px; line-height: 20px;">',s+="Target Affiliate Location",s+="<br />",s+=i.status,s+="</div>"):(s+='<a href="'+i.url+'">'+i.title+"</a></div>",s+='<div style="text-align: center; font-size: 15px; line-height: 24px;">',"undefined"!=typeof i.street_address&&(s+=i.street_address+"<br />"),"undefined"!=typeof i.phone&&(s+=i.phone+" | "),"undefined"!=typeof i.email&&(s+='<a href="mailto:'+i.email+'">Email Us</a>'),s+="</div>",s+='<a class="map-go-button" href="'+i.url+'">GO</a>'),s+="</div>",o.infoWindow=new google.maps.InfoWindow({}),o.infoWindow.setContent(s),google.maps.event.addListener(o,"click",function(){t.markerClicked(this)})}})},this)).error(function(e){console.log("error"),console.log(e)})},markerClicked:function(e){null!==this.openInfoWindow&&this.openInfoWindow.close(),e.infoWindow.open(this.map,e),this.openInfoWindow=e.infoWindow},mapClicked:function(){null!==this.openInfoWindow&&(this.openInfoWindow.close(),this.openInfoWindow=null)},zoomChanged:function(){if(this.callToActionVisible){var e=this.$el.parent().find("#affiliate-map-cta-arrow");tween.to(e,3,{autoAlpha:0}),this.callToActionVisible=!1}}})}(jQuery);